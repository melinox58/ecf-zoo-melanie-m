{% extends 'base.html.twig' %}

{% block title %}Marais{% endblock %}

{% block body %}

<section class="titleServ">
    <h3 class="h3Hab">Marais</h3>
    <div class="rectangle"></div>
</section>

<img class="habitat" src="{{ asset('/images/marais/marais.jpg') }}" alt="Entrée du zoo">
<div class="habitmar">
    <p>Les marais, zones humides situées entre terre et eau, offrent un habitat riche et
    diversifié qui joue un rôle essentiel dans les écosystèmes.<br>
    La végétation des marais est adaptée à un environnement gorgé d'eau. On y trouve des plantes
    aquatiques comme les roseaux, les joncs et les nénuphars, ainsi que des arbres comme les cyprès
    chauves et les saules, dont les racines plongent dans l'eau stagnante. Les herbes hautes et les mousses
    prolifèrent, formant des abris pour de nombreuses espèces.<br>
    Les marais abritent une faune variée, adaptée à ces zones humides. Les oiseaux aquatiques tels que les hérons,
    cigognes et canards y sont fréquents. Les mammifères comme les castors, loutres, ou encore les ratons laveurs
    y trouvent refuge. Les eaux stagnantes sont le domaine des grenouilles, serpents d'eau, et tortues, tandis
    que des poissons comme les brochets et les perches prospèrent dans les zones immergées. Les insectes,
    notamment les libellules et les moustiques, y jouent un rôle important dans l'écosystème.<br>
    Les marais, véritables réservoirs de biodiversité, servent également de filtres naturels pour l'eau et de zones
    tampons contre les inondations, bien qu'ils soient menacés par le drainage et l'urbanisation.</p>
</div>

<section class="latest-report">
    <h4>Dernier rapport vétérinaire sur cet habitat</h4>
    {% if latestReport %}
    <p>Dernier rapport vétérinaire pour cet habitat : {{ latestReport.date|date('d-m-Y H:i') }}</p>
    <p>{{ latestReport.comment }}</p>
{% else %}
    <p>Aucun rapport vétérinaire disponible pour cet habitat.</p>
{% endif %}
</section>

{# Cards d'animaux des marais #}
<section class="animaux">
    <div class="row">
        {% for animal in maraisAnimals %}
                <div class="card marais">
                    <img class="card-img" src="{{ asset('uploads/animals/mini/250x250-' ~ animal.images[0].getFilePath) }}" alt="{{ animal.nameAnimal }}" class="img-thumbnail" width="100">
                    <div class="card-body">
                        <h5 class="card-title">{{ animal.nameAnimal }}</h5>
                        <p class="card-text">{{ animal.description }}</p>
                        
                            <!-- Button trigger modal -->
                        <button type="button" class="jungle btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-{{ animal.id }}" data-id="{{ animal.id }}" data-habitat="marais">
                            Détails
                        </button>

                        <!-- Modal -->
                        <div class="modal fade" id="modal-{{ animal.id }}" tabindex="-1" aria-labelledby="modalLabel-{{ animal.id }}" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-scrollable">
                                <div class="modal-contentCard">
                                    <div class="modal-header">
                                        <h3 class="modal-title fs-5" id="modalLabel-{{ animal.id }}">{{ animal.nameAnimal }}</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <img class="cardModal-img" src="{{ asset('uploads/animals/mini/250x250-' ~ animal.images[0].getFilePath) }}" alt="{{ animal.nameAnimal }}" class="img-thumbnail" width="100">
                                        <p class="card-text">{{ animal.description }}</p>
                                        <h4>Comptes rendus</h4>
                                        <div class="table-responsive-modal">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Commentaire</th>
                                                        <th>Aliments donnés</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for report in reportsByAnimal[animal.id] %}
                                                        <tr>
                                                            <td>{{ report.date|date('d/m/Y H:i') }}</td>
                                                            <td>{{ report.comment }}</td>
                                                            <td>{{ report.idFoods.name }} - {{ report.weight }} {{ report.unit }}</td>
                                                        </tr>
                                                    {% else %}
                                                        <tr>
                                                            <td colspan="3">Aucun rapport disponible.</td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>    
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        {% endfor %}
    </div>
</section>
{% endblock %}