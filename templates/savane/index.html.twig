{% extends 'base.html.twig' %}

{% block title %}Savane{% endblock %}

{% block body %}

<section class="titleServ">
    <h3 class="h3Hab">Savane</h3>
    <div class="rectangle"></div>
</section>

<img class="habitat" src="{{ asset('/images/savane/savane.jpg') }}" alt="Entrée du zoo">
<div class="habitsav">
    <p>La savane, vaste étendue herbeuse parsemée d'arbres clairsemés, se distingue par une faune
    et une flore adaptées à un climat tropical alternant saisons sèches et humides.<br>
    La végétation de la savane est dominée par des herbes hautes, telles que les graminées, qui peuvent
    atteindre plusieurs mètres de hauteur. On y trouve également des arbres isolés et résistants
    à la sécheresse, comme les baobabs, les acacias et les palmiers doum. Ces arbres, souvent dotés
    de feuilles réduites ou d'épines, minimisent la perte d'eau et offrent de l'ombre aux animaux.<br>
    La savane est célèbre pour sa faune emblématique et abondante. Elle abrite de grands herbivores
    tels que les éléphants, girafes, zèbres, gnous et antilopes, qui se nourrissent des herbes et
    des feuilles des arbres. Les prédateurs comme les lions, guépards, hyènes et léopards règnent
    sur cette vaste plaine. Les rivières et points d’eau attirent des hippopotames, crocodiles et
    de nombreuses espèces d’oiseaux aquatiques. Par ailleurs, des insectes comme les termites et
    les mouches tsé-tsé jouent un rôle crucial dans l’écosystème.<br>
    La savane, bien que souvent associée à l'Afrique, se retrouve également en Amérique du Sud et en
    Australie. Elle est essentielle à l'équilibre écologique, mais reste vulnérable face au changement
    climatique et aux activités humaines.</p>
</div>

<section class="latest-report">
    <h4>Dernier rapport vétérinaire sur cet habitat</h4>
    {% if latestReport %}
    <p>Dernier rapport vétérinaire pour cet habitat : {{ latestReport.date|date('d-m-Y H:i') }}</p>
    <p>{{ latestReport.comment }}</p>
{% else %}
    <p>Aucun rapport vétérinaire disponible pour cet habitat.</p>
{% endif %}
</section>

{# Cards d'animaux de la savane #}
<section class="animaux">
    <div class="row">
        {% for animal in savaneAnimals %}
                <div class="card savane">
                    <img class="card-img" src="{{ asset('uploads/animals/mini/250x250-' ~ animal.images[0].getFilePath) }}" alt="{{ animal.nameAnimal }}" class="img-thumbnail" width="100">
                    <div class="card-body">
                        <h5 class="card-title">{{ animal.nameAnimal }}</h5>
                        <p class="card-text">{{ animal.description }}</p>
                        
                        <!-- Button trigger modal -->
                        <button type="button" class="jungle btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-{{ animal.id }}">
                            Détails
                        </button>

                        <!-- Modal -->
                        <div class="modal fade" id="modal-{{ animal.id }}" tabindex="-1" aria-labelledby="modalLabel-{{ animal.id }}" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-scrollable">
                                <div class="modal-contentCard">
                                    <div class="modal-header">
                                        <h3 class="modal-title fs-5" id="modalLabel-{{ animal.id }}">{{ animal.nameAnimal }}</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <img class="cardModal-img" src="{{ asset('uploads/animals/mini/250x250-' ~ animal.images[0].getFilePath) }}" alt="{{ animal.nameAnimal }}" class="img-thumbnail" width="100">
                                        <p class="card-text">{{ animal.description }}</p>
                                        <h4>Comptes rendus</h4>
                                        <div class="table-responsive-modal">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Commentaire</th>
                                                        <th>Aliments donnés</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for report in reportsByAnimal[animal.id] %}
                                                        <tr>
                                                            <td>{{ report.date|date('d/m/Y H:i') }}</td>
                                                            <td>{{ report.comment }}</td>
                                                            <td>{{ report.idFoods.name }} - {{ report.weight }} {{ report.unit }}</td>
                                                        </tr>
                                                    {% else %}
                                                        <tr>
                                                            <td colspan="3">Aucun rapport disponible.</td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>    
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        {% endfor %}
    </div>
</section>
{% endblock %}